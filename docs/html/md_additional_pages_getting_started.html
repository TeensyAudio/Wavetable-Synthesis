<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Teensy Wavetable Synthesis: Getting started</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Teensy Wavetable Synthesis
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_additional_pages_getting_started.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Getting started </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is a short guide on how to get started using the Audio Synth Wavetable library.</p>
<h1><a class="anchor" id="WhatIs"></a>
What is the Audio Synth Wavetable library?</h1>
<p>The Audio Synth Wavetable is a C++ library uses sound data from a decoded SoundFont file and creates sound using wavetable synthesis. This library is for <a href="https://www.pjrc.com/teensy/">Teensy 3.2/3.6</a>.</p>
<h1><a class="anchor" id="howtoUse"></a>
How do I use the Audio Synth Wavetable library?</h1>
<p>To use the Audio Synth Wavetable library you must include the header file in your Arduino sketch (a <code>.ino</code> file):</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;AudioSynthWavetable.h&gt;</span></div></div><!-- fragment --><p>The <code><a class="el" href="_audio_synth_wavetable_8h_source.html">AudioSynthWavetable.h</a></code> and <code>AudioSynthWavetable.cpp</code> files need to be in your Arduino library folder.</p>
<h1><a class="anchor" id="decoder"></a>
Decoding Soundfont Files</h1>
<p>See <a href="https://teensyaudio.github.io/Wavetable-Synthesis/html/md_additional_pages_soundfont_decoder.html">SoundFont Decoder User-Guide</a> for information on how to decode a .sf2 file to a usable format for the <code><a class="el" href="class_audio_synth_wavetable.html">AudioSynthWavetable</a></code> class.</p>
<h1><a class="anchor" id="including"></a>
Including a Soundfont File in an Arduino Sketch</h1>
<p>When creating a sketch that uses the <code><a class="el" href="class_audio_synth_wavetable.html">AudioSynthWavetable</a></code> class, the output files from the soundfont decoder (in the form of .cpp and .h files) need to be placed in the same directory as the Arduino sketch. Once these files are in the same directory, within the Arduino sketch code, <code>#include "&lt;instrument-name&gt;_samples.h"</code> must be added to the top of the sketch in order to use it with the wavetable class.</p>
<h1><a class="anchor" id="locating"></a>
Locating the instrument_data Within the Decoded Files</h1>
<p>An instance of the <code><a class="el" href="class_audio_synth_wavetable.html">AudioSynthWavetable</a></code> object requires a complete <code>instrument_data</code> object to be passed to the wavetable object. The instrument_data object can be found in the <code>&lt;instrument-name&gt;_samples.h</code> file that was included from the output files from the SoundfontDecoder (see <a href="#including"><code>Including a Soundfont File in an Arduino Sketch</code></a> above).</p>
<h1><a class="anchor" id="settingObject"></a>
Setting up an AudioSynthWavetable Object</h1>
<h2><a class="anchor" id="AudioConnectios"></a>
Audio Connections</h2>
<p>Before using an <a class="el" href="class_audio_synth_wavetable.html">AudioSynthWavetable</a> Object to synthesize music, it will be necessary to set up some audio connection objects. See the Teensy Audio Library documentation at <a href="https://www.pjrc.com/teensy/td_libs_Audio.html">https://www.pjrc.com/teensy/td_libs_Audio.html</a> for information on using AudioConnection objects to connect the <a class="el" href="class_audio_synth_wavetable.html">AudioSynthWavetable</a> object to mixers and audio output drivers for your specific Teensy board.</p>
<h2><a class="anchor" id="settingInst"></a>
Setting an Object's Instrument</h2>
<p>To set an object's instrument, be sure that the .h and .cpp files from the SoundfontDecoder have been included in your Arduino sketch, and locate the name of the instrument_data object in the <code>&lt;instrument-name&gt;_samples.h</code> file. For example it will look something like this for an instrument named "BasicFlute1":</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> instrument_data BasicFlute1 = {2, BasicFlute1_ranges, BasicFlute1_samples };</div></div><!-- fragment --><p>In this example, assume that <code>AudioSynthWavetable wavetable;</code> is already placed in the variable declaration section of the Arduino sketch, and assume the instrument_data object that gets passed to the <a class="el" href="class_audio_synth_wavetable.html">AudioSynthWavetable</a> object is named <code>BasicFlute1</code>. To set the instrument of a particular wavetable object, perform the following:</p>
<div class="fragment"><div class="line">wavetable.setInstrument(BasicFlute1);</div></div><!-- fragment --><p>Now, the wavetable's instrument has been set, and the object can now be used to synthesize instrument sounds.</p>
<h1><a class="anchor" id="firstProg"></a>
A very simple first program</h1>
<p>This program is meant to be played using the Teensy development board that has a button on pin 1, and analog knobs on A2 and A3.</p>
<p>Frequency and amplitude are modified using the knobs, and the flute is triggered to play/stop via the button on pin #1.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;Bounce.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;Audio.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;Wire.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;SPI.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;SD.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;SerialFlash.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;AudioSynthWavetable.h&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;BasicFlute1_samples.h&quot;</span></div><div class="line"></div><div class="line"><a class="code" href="class_audio_synth_wavetable.html">AudioSynthWavetable</a> wavetable;</div><div class="line">AudioOutputI2S i2s1;</div><div class="line">AudioMixer4 mixer;</div><div class="line">AudioConnection patchCord1(wavetable, 0, mixer, 0);</div><div class="line">AudioConnection          patchCord2(mixer, 0, i2s1, 0);</div><div class="line">AudioConnection          patchCord3(mixer, 0, i2s1, 1);</div><div class="line">AudioControlSGTL5000 sgtl5000_1;</div><div class="line"></div><div class="line"><span class="comment">// Bounce objects to read pushbuttons </span></div><div class="line">Bounce button0 = Bounce(0, 15);</div><div class="line">Bounce button1 = Bounce(1, 15);  <span class="comment">// 15 ms debounce time</span></div><div class="line">Bounce button2 = Bounce(2, 15);</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> setup() { </div><div class="line">  Serial.begin(115200);</div><div class="line">  pinMode(0, INPUT_PULLUP);</div><div class="line">  pinMode(1, INPUT_PULLUP);</div><div class="line">  pinMode(2, INPUT_PULLUP);</div><div class="line">  AudioMemory(20);</div><div class="line">  sgtl5000_1.enable();</div><div class="line">  sgtl5000_1.volume(0.8);</div><div class="line">  mixer.gain(0, 0.7);</div><div class="line"></div><div class="line">  wavetable.<a class="code" href="class_audio_synth_wavetable.html#aca90211dbcfa25332cffe3496ff62e51">setInstrument</a>(BasicFlute1);</div><div class="line">  wavetable.<a class="code" href="class_audio_synth_wavetable.html#a6621dec194472cd178c4c7b557a1d9e0">amplitude</a>(1);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">bool</span> playing = <span class="keyword">false</span>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> loop() {</div><div class="line">  <span class="comment">// Update all the button objects</span></div><div class="line">  button0.update();</div><div class="line">  button1.update();</div><div class="line">  button2.update();</div><div class="line">  <span class="comment">//Read knob values</span></div><div class="line">  <span class="keywordtype">int</span> knob1 = analogRead(A3);</div><div class="line">  <span class="keywordtype">int</span> knob2 = analogRead(A2);</div><div class="line">  <span class="comment">//Get frequency and gain from knobs</span></div><div class="line">  <span class="keywordtype">float</span> freq = (float)knob1/5.0;</div><div class="line">  <span class="keywordtype">float</span> gain = (float)knob2/1023.0;</div><div class="line">  <span class="comment">//Set a low-limit to the gain</span></div><div class="line">  <span class="keywordflow">if</span> (gain &lt; .05) gain = .05;</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (button1.fallingEdge()) {</div><div class="line">    <span class="keywordflow">if</span> (playing) {</div><div class="line">      playing = <span class="keyword">false</span>;</div><div class="line">      wavetable.<a class="code" href="class_audio_synth_wavetable.html#a36bbb6732768963bea068e9a24e95675">stop</a>();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> {</div><div class="line">      playing = <span class="keyword">true</span>;</div><div class="line">      wavetable.<a class="code" href="class_audio_synth_wavetable.html#a60adfe8dacbf241920beee4bc7b734d7">playFrequency</a>(freq);</div><div class="line">      wavetable.<a class="code" href="class_audio_synth_wavetable.html#a6621dec194472cd178c4c7b557a1d9e0">amplitude</a>(gain);</div><div class="line">    }    </div><div class="line">  }</div><div class="line">  wavetable.<a class="code" href="class_audio_synth_wavetable.html#a6621dec194472cd178c4c7b557a1d9e0">amplitude</a>(gain);</div><div class="line">  wavetable.<a class="code" href="class_audio_synth_wavetable.html#abca36de495959df7c5b5e0a2d9e6a983">setFrequency</a>(freq);</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
